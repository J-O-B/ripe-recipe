{% extends "base.html" %}
{% block main_content %}

    {% for recipes in recipe %}
    <div class="row">
        <div class="col s12 m6 offset-m3">
            <h4 class="center-align black-text text-lighten-2 border round-border"><strong>{{ recipes.recipe_name|capitalize }}</strong></h4>
        </div>
    </div>
            <!--Top Section-->
            <div class="row">
                <div class="col s10 offset-s1 m4 grey lighten-2 top-recipe-card border soft-corners">
                    <!--Recipe Image-->
                    <img class="recipe-image soft-corners" src="{{ recipes.pic_url }}" alt="{{ recipes.recipe_name }} picture">
                </div>
                <div class="col s10 offset-s1 m8 top-recipe-card">
                    <!--Left Block-->
                    <div class="col m6 s12 left-block">
                        <p><strong>Category: </strong> <span class="center-align">{{ recipes.category_name|capitalize }}</span></p>
                        <p><strong>Name: </strong> <span class="center-align">{{ recipes.recipe_name|capitalize }}</span></p>
                        <p><strong>Prep Time: </strong><span class="center-align">{{ recipes.prep_time }} min</span></p>
                        <p><strong>Cooking Time: </strong><span class="center-align">{{ recipes.cooking_time }} min</span></p>
                    </div>
                    <!--Right Block-->
                    <div class="col m6 s12 right-block">
                        <p><strong>Difficulty: </strong><span class="center-align">{{ recipes.difficulty|capitalize }}</span></p>
                        <p><strong>Description: </strong><span class="center-align">{{ recipes.description|capitalize }}</span></p>
                    </div>
                </div>

            <!-- If the current user created the recipe -->
            {% if recipes.created_by == session["user"] %}
                <div class="row">
                    <h3 class="It Looks Like You Are The Creator Of This Recipe!"></h3>
                    
                    <div class="col s3 offset-s2">
                        <form  method="POST" action="{{ url_for('editrecipe', id=recipes._id) }}">
                            <input class="hidden" name="name" id="name" value="{{ recipes.recipe_name }}">
                            <button type="submit" value="{{ recipes.recipe_name }}" class="col s12 btn-large green accent-3 black-text soft-corners">
                                    View More
                            </button>
                        </form>
                    </div>
                    <div class="col s3 offset-s2">
                        <button class="btn-large red">Request Delete</button>
                    </div>
                </div>
            {% endif %}
            <!--Nutrition Row-->
            <div class="row">
                <div class="col s10 offset-s1 center-align">
                    <h3>Nutrition</h3>
                    <hr class="custom-short-div">
                </div>
                        <div class="col s3 center-align">
                            <p><strong>KCAL</strong><br>{{ recipes.kcal }}</p>
                        </div>
                        <div class="col s3 center-align">
                            <p><strong>Fat</strong><br>{{ recipes.fat }}g</p>
                        </div>
                        <div class="col s3 center-align">
                            <p><strong>Saturates</strong><br>{{ recipes.saturates }}g</p>
                        </div>
                        <div class="col s3 center-align">
                            <p><strong>Carbs</strong><br>{{ recipes.carbs }}g</p>
                        </div>
                        <div class="col s3 center-align">
                            <p><strong>Sugars</strong><br>{{ recipes.sugars }}g</p>
                        </div>
                        <div class="col s3 center-align">
                            <p><strong>Fibre</strong><br>{{ recipes.fibre }}g</p>
                        </div>
                        <div class="col s3 center-align">
                            <p><strong>Protein</strong><br>{{ recipes.protein }}g</p>
                        </div>
                        <div class="col s3 center-align">
                            <p><strong>Salt</strong><br>{{ recipes.salt }}g</p>
                        </div>
                    </div>

            <!--Bottom Section-->
            <div class="row">
                <div class="col s10 offset-s1 m6">
                    <h3 class="center-align">Ingredients:</h3>
                    <hr class="custom-short-div">
                    {% set list1 = recipes.ingredients.split('.') %}
                        <ul>
                        {% for item in list1 %}
                            {% if item|length != 0 %}
                                <li>{{ item|capitalize }}.</li>
                            {% endif %}
                        {% endfor %} 
                        </ul>
                </div>
                <div class="col s10 offset-s1 m6">
                    <h3 class="center-align">Instructions:</h3>
                    <hr class="custom-short-div">
                    <!--Convert instructions string into a list-->
                    {% set list2 = recipes.instructions.split('.') %}
                        <ol>
                        <!--Run through new list of instructions-->
                        {% for item in list2 %}
                            <!--Stop an empty last list item-->
                            {% if item|length != 0 %}
                                <li>{{ item|capitalize }}.</li>
                            {% endif %}
                        {% endfor %}     
                        </ol>     
                </div>
            </div>
            <div class="row">
                <div class="col s10 offset-s1">
                    <form  method="POST" action="{{ url_for('user', user=recipes.created_by) }}">
                        <input class="hidden" name="user" id="user" value="{{ recipes.created_by }}">
                        <button type="submit" value="{{ recipes.created_by }}" class="col s12 btn-large green accent-3 black-text soft-corners">
                                This Recipe Was Created By {{ recipes.created_by }}, View More Of {{ recipes.created_by }}'s Recipes
                        </button>
                    </form>
                </div>
            </div>
            <!--Comments Section-->
            <div class="row blue lighten-2 round-corners">
                {% if session["user"] %}
                <!--Leave A Message-->
                    <form class="col s10 offset-s1" id="recipe-comments" method="POST" action="{{ url_for('selected', id=recipes._id) }}">
                        <div class="row white round-corners">
                            <div class="input-field col s12">
                                <div class="col s1">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <div class="col s11">
                                    <input name="recipe-comment" id="recipe-comment" type="text" placeholder="Write Your Comment Here..." class="validate" required>
                                    <label for="recipe-comment">Recipe Comment</label>
                                </div>
                            </div>
                            <div class="input-field col s12">
                                <div class="col s1">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="col s11">
                                    <select id="rating-comment" name="rating-comment">
                                        <option value="" disabled selected>Your Rating:</option>
                                        <option value="1">
                                            &#10031;
                                        </option>
                                        <option value="2">
                                            &#10031;
                                            &#10031;
                                        </option>
                                        <option value="3">
                                            &#10031;
                                            &#10031;
                                            &#10031;
                                        </option>
                                        <option value="4">
                                            &#10031;
                                            &#10031;
                                            &#10031;
                                            &#10031;
                                        </option>
                                        <option value="5">
                                            &#10031;
                                            &#10031;
                                            &#10031;
                                            &#10031;
                                            &#10031;
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <button class="btn-large green lighten-2 col s12" type="submit" value="0" name="leaveComment" id="leaveComment">Submit Comment <i class="fas fa-share-square"></i></button>
                    </form>
                {% endif %}
                {% for message in messages %}
                <div class="row">
                    <div class="col s10 offset-s1">
                        <div class="col s12 m4">
                            <p>Message Left: <span>{{ message.date }}</span></p>
                            <p>Message From: <span>{{ message.message_from|capitalize }}</span></p>
                            <p>Rating: 
                                {% if message.rating == "1" %}
                                <span>&#10031;</span>
                                {% elif message.rating == "2" %}
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                {% elif message.rating == "3" %}
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                {% elif message.rating == "4" %}
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                {% elif message.rating == "5" %}
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                <span>&#10031;</span>
                                {% endif %}
                            </p> 
                        </div>
                        <div class="col s12 m8">
                            <h6>Comment:</h6>
                            <p>{{ message.message_text }}</p>
                        </div>
                    </div>
                </div>
                <hr class="comments-div">
                {% endfor %}
            </div>
        {% endfor %}

        
{% endblock %}